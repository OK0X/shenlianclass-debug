(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[9],{"464f":function(e,a,t){},8216:function(e,a,t){"use strict";var s=t("464f"),n=t.n(s);n.a},fe7c:function(e,a,t){"use strict";t.r(a);var s=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("q-page",{staticClass:"mypage"},[t("GoBack"),t("div",{staticClass:"page-content",staticStyle:{"margin-top":"5px"}},[t("div",{staticStyle:{display:"flex"}},[t("span",{staticClass:"ask-title"},[e._v(e._s(e.ask.title))]),e.ask.reward?t("img",{staticClass:"reward-icon",attrs:{src:"statics/coin.png"}}):e._e(),e.ask.reward?t("span",{staticClass:"reward-tx"},[e._v(e._s(e.ask.reward_num))]):e._e()]),t("div",{directives:[{name:"highlight",rawName:"v-highlight"}],domProps:{innerHTML:e._s(e.ask.detail)}}),e.ask.user_id!==e.user.uuid&&""===e.myanswer?t("div",{staticClass:"flex-col"},[t("q-btn",{staticStyle:{width:"90px","margin-top":"15px"},attrs:{unelevated:"",color:"primary",label:"我来回答"},on:{click:e.ianswer}}),t("VueEditor",{directives:[{name:"show",rawName:"v-show",value:e.editorShow,expression:"editorShow"}],staticStyle:{height:"300px",width:"100%",margin:"10px 0 50px 0"},attrs:{useCustomImageHandler:""},on:{"image-added":e.handleImageAdded},model:{value:e.myanswerInput,callback:function(a){e.myanswerInput=a},expression:"myanswerInput"}}),t("q-btn",{directives:[{name:"show",rawName:"v-show",value:e.editorShow,expression:"editorShow"}],staticStyle:{width:"100px","align-self":"flex-end","margin-top":"10px"},attrs:{unelevated:"",color:"primary",label:"提交回答"},on:{click:e.submitAnswer}})],1):e._e(),t("div",{staticStyle:{display:"flex",margin:"20px 0 20px 0"}},[t("span",{staticStyle:{"font-size":"18px",color:"#7a8f9a","font-weight":"700"}},[e._v(e._s(e.totalAnswerNum)+"个回答")]),t("div",{staticStyle:{flex:"1",height:"1px",background:"rgba(0, 0, 0, 0.06)","align-self":"center","margin-left":"10px"}})]),t("CommentReply",{directives:[{name:"show",rawName:"v-show",value:""!==e.myanswer,expression:"myanswer!==''"}],attrs:{answerType:"myanswer",answer:e.myanswer,ask:"[object Object]"===e.$route.query.arg?e.global.routeCache.askDetail:e.$route.query.arg,option:e.CROption},on:{acceptAnswerOK:e.acceptAnswerOK,needLogin:e.needLogin}}),t("q-separator",{directives:[{name:"show",rawName:"v-show",value:""!==e.myanswer,expression:"myanswer!==''"}],staticStyle:{margin:"20px 0 20px 0",background:"rgba(0, 0, 0, 0.06)"}}),t("CommentReply",{directives:[{name:"show",rawName:"v-show",value:""!==e.acceptanswer&&e.acceptanswer.user_id!==e.user.uuid,expression:"acceptanswer!==''&&acceptanswer.user_id!==user.uuid"}],attrs:{answerType:"acceptanswer",answer:e.acceptanswer,ask:"[object Object]"===e.$route.query.arg?e.global.routeCache.askDetail:e.$route.query.arg,option:e.CROption},on:{needLogin:e.needLogin}}),t("q-separator",{directives:[{name:"show",rawName:"v-show",value:""!==e.acceptanswer&&e.acceptanswer.user_id!==e.user.uuid,expression:"acceptanswer!==''&&acceptanswer.user_id!==user.uuid"}],staticStyle:{margin:"20px 0 20px 0",background:"rgba(0, 0, 0, 0.06)"}}),e._l(e.answers,(function(a,s){return t("div",{key:s,staticClass:"flex-col"},[t("CommentReply",{attrs:{answerType:"other",answer:a,ask:"[object Object]"===e.$route.query.arg?e.global.routeCache.askDetail:e.$route.query.arg,option:e.CROption},on:{acceptAnswerOK:e.acceptAnswerOK,needLogin:e.needLogin}}),s!==e.answers.length-1?t("q-separator",{staticStyle:{margin:"20px 0 20px 0",background:"rgba(0, 0, 0, 0.06)"}}):e._e()],1)})),e.pageMax>1?t("q-pagination",{staticStyle:{"margin-top":"30px","align-self":"center"},attrs:{max:e.pageMax,"direction-links":!0},on:{input:e.paginationClick},model:{value:e.currentPage,callback:function(a){e.currentPage=a},expression:"currentPage"}}):e._e()],2),t("MyFooter"),t("LoginDialog",{attrs:{dialogData:e.loginDialog}})],1)},n=[],i=(t("7f7f"),t("a3d9")),r=t("198e"),o=t("5873"),c=t("51ff"),m=t("f5ef"),u=t("a002"),w=t.n(u),l=t("373b"),d={components:{GoBack:r["a"],VueEditor:o["a"],MyFooter:i["a"],LoginDialog:c["a"],CommentReply:l["a"]},data:function(){return{CROption:{showCai:!0},ask:"",editorShow:!1,myanswerInput:"",answers:[],myanswer:"",acceptanswer:"",totalAnswerNum:0,loginDialog:{show:!1,title:"快捷登陆"},zcClickNum:{},currentPage:1,lastPage:1,offset:0,limit:20,pageMax:1}},computed:{user:{get:function(){return this.$store.state.user.user},set:function(e){this.$store.commit("user/updateUser",e)}}},mounted:function(){var e=this;"[object Object]"===this.$route.query.arg?this.ask=this.global.routeCache.askDetail:(this.ask=this.$route.query.arg,this.global.routeCache.askDetail=this.ask),m["a"].$on("logout",(function(){e.getAnswer()})),m["a"].$on("loginok",(function(){e.getAnswer()})),this.getAnswer()},methods:{paginationClick:function(e){this.lastPage!==e&&(this.offset+=this.limit*(e-this.lastPage),this.lastPage=e,this.getAnswer())},getAnswer:function(){var e=this,a=(new Date).getTime()+this.global.requestExpireT,t={ask_id:this.ask.uuid,limit:this.limit+"",offset:this.offset+""};"undefined"!==typeof this.user.uuid&&(t.user_id=this.user.uuid),this.$axios.get(this.global.api.backurl+"ask/getAnswer",{params:t,headers:{"access-token":this.util.generateToken(JSON.stringify(t),a),timestamp2:a}}).then((function(a){if(200===a.status&&0===a.data.code){var t=a.data.data.total[0].total;e.pageMax=Math.ceil(t/e.limit);for(var s=a.data.data.answers,n=0;n<s.length;n++){s[n].comments_show=!1,s[n].comment_new="",s[n].nickname="",s[n].avatar="",s[n].zan=!1,s[n].cai=!1;for(var i=0;i<s[n].comments.length;i++)s[n].comments[i].comments_show=!1,s[n].comments[i].comment_new="",s[n].comments[i].nickname="",s[n].comments[i].avatar="",s[n].comments[i].zan=!1}e.answers=s,e.totalAnswerNum=t;var r=a.data.data.myanswer;if(""!==r){e.totalAnswerNum++,r.comments_show=!1,r.comment_new="",r.nickname=e.user.nick,r.avatar=e.user.avatar,r.zan=!1,r.cai=!1;for(var o=0;o<r.comments.length;o++)r.comments[o].comments_show=!1,r.comments[o].comment_new="",r.comments[o].nickname="",r.comments[o].avatar="",r.comments[o].zan=!1;e.myanswer=r}else e.myanswer="";var c=a.data.data.acceptanswer;if(""!==c){e.totalAnswerNum++,c.comments_show=!1,c.comment_new="",c.nickname="",c.avatar="",c.zan=!1,c.cai=!1;for(var m=0;m<c.comments.length;m++)c.comments[m].comments_show=!1,c.comments[m].comment_new="",c.comments[m].nickname="",c.comments[m].avatar="",c.comments[m].zan=!1;e.acceptanswer=c}e.getNicknames(),e.getZanCai()}})).catch((function(e){console.log(e)}))},getZanCai:function(){for(var e=this,a=[],t=0;t<this.answers.length;t++){a.push(this.answers[t].uuid);for(var s=0;s<this.answers[t].comments.length;s++)a.push(this.answers[t].comments[s].uuid)}if(""!==this.myanswer){a.push(this.myanswer.uuid);for(var n=0;n<this.myanswer.comments.length;n++)a.push(this.myanswer.comments[n].uuid)}if(""!==this.acceptanswer){a.push(this.acceptanswer.uuid);for(var i=0;i<this.acceptanswer.comments.length;i++)a.push(this.acceptanswer.comments[i].uuid)}if(0!==a.length){var r=(new Date).getTime()+this.global.requestExpireT,o={user_id:this.user.uuid,ask_id:this.ask.uuid,ans_com_id:encodeURIComponent(JSON.stringify(a))};this.$axios.get(this.global.api.backurl+"ask/getZanCai",{params:o,headers:{"access-token":this.util.generateToken(JSON.stringify(o),r),timestamp2:r}}).then((function(a){if(200===a.status&&0===a.data.code){for(var t=a.data.data,s={},n=0;n<t.length;n++)s[t[n].ans_com_id]={zan:t[n].zan,cai:t[n].cai};if(""!==e.myanswer){"undefined"!==typeof s[e.myanswer.uuid]?(e.myanswer.zan=s[e.myanswer.uuid].zan,e.myanswer.cai=s[e.myanswer.uuid].cai):(e.myanswer.zan=!1,e.myanswer.cai=!1);for(var i=0;i<e.myanswer.comments.length;i++)"undefined"!==typeof s[e.myanswer.comments[i].uuid]?e.myanswer.comments[i].zan=s[e.myanswer.comments[i].uuid].zan:e.myanswer.comments[i].zan=!1}if(""!==e.acceptanswer){"undefined"!==typeof s[e.acceptanswer.uuid]?(e.acceptanswer.zan=s[e.acceptanswer.uuid].zan,e.acceptanswer.cai=s[e.acceptanswer.uuid].cai):(e.acceptanswer.zan=!1,e.acceptanswer.cai=!1);for(var r=0;r<e.acceptanswer.comments.length;r++)"undefined"!==typeof s[e.acceptanswer.comments[r].uuid]?e.acceptanswer.comments[r].zan=s[e.acceptanswer.comments[r].uuid].zan:e.acceptanswer.comments[r].zan=!1}for(var o=0;o<e.answers.length;o++){"undefined"!==typeof s[e.answers[o].uuid]?(e.answers[o].zan=s[e.answers[o].uuid].zan,e.answers[o].cai=s[e.answers[o].uuid].cai):(e.answers[o].zan=!1,e.answers[o].cai=!1);for(var c=0;c<e.answers[o].comments.length;c++)"undefined"!==typeof s[e.answers[o].comments[c].uuid]?e.answers[o].comments[c].zan=s[e.answers[o].comments[c].uuid].zan:e.answers[o].comments[c].zan=!1}}})).catch((function(e){console.log(e)}))}},getNicknames:function(){for(var e=this,a=(new Date).getTime()+this.global.requestExpireT,t=[],s=0;s<this.answers.length;s++){t.push(this.answers[s].user_id);for(var n=0;n<this.answers[s].comments.length;n++)t.push(this.answers[s].comments[n].user_id)}if(""!==this.myanswer){t.push(this.myanswer.user_id);for(var i=0;i<this.myanswer.comments.length;i++)t.push(this.myanswer.comments[i].user_id)}if(""!==this.acceptanswer){t.push(this.acceptanswer.user_id);for(var r=0;r<this.acceptanswer.comments.length;r++)t.push(this.acceptanswer.comments[r].user_id)}if(0!==t.length){var o={uuid:encodeURIComponent(JSON.stringify(t))};this.$axios.get(this.global.api.backurl+"user/getNames",{params:o,headers:{"access-token":this.util.generateToken(JSON.stringify(o),a),timestamp2:a}}).then((function(a){if(200===a.status&&0===a.data.code){for(var t=a.data.data,s={},n={},i=0;i<t.length;i++)s[t[i].uuid]=t[i].nick,n[t[i].uuid]=t[i].avatar;for(var r=0;r<e.answers.length;r++){e.answers[r].nickname=s[e.answers[r].user_id],e.answers[r].avatar=n[e.answers[r].user_id];for(var o=0;o<e.answers[r].comments.length;o++)e.answers[r].comments[o].nickname=s[e.answers[r].comments[o].user_id],e.answers[r].comments[o].avatar=n[e.answers[r].comments[o].user_id]}if(""!==e.myanswer)for(var c=0;c<e.myanswer.comments.length;c++)e.myanswer.comments[c].nickname=s[e.myanswer.comments[c].user_id],e.myanswer.comments[c].avatar=n[e.myanswer.comments[c].user_id];if(""!==e.acceptanswer){e.acceptanswer.nickname=s[e.acceptanswer.user_id],e.acceptanswer.avatar=n[e.acceptanswer.user_id];for(var m=0;m<e.acceptanswer.comments.length;m++)e.acceptanswer.comments[m].nickname=s[e.acceptanswer.comments[m].user_id],e.acceptanswer.comments[m].avatar=n[e.acceptanswer.comments[m].user_id]}}})).catch((function(e){console.log(e)}))}},needLogin:function(){this.loginDialog.show=!0},acceptAnswerOK:function(){this.getAnswer(),this.ask.hasaccept=!0},submitAnswer:function(){var e=this;if("undefined"===typeof this.user.uuid)return toast("请先登陆后再回答"),void(this.loginDialog.show=!0);if(""!==this.myanswerInput){this.util.loadingShow(this);var a={user_id:this.user.uuid,ask_id:this.ask.uuid,content:this.myanswerInput},t=(new Date).getTime()+this.global.requestExpireT;this.$axios.post(this.global.api.backurl+"ask/createAnswer",a,{headers:{"access-token":this.util.generateToken(JSON.stringify(a),t),timestamp2:t}}).then((function(a){if(e.util.loadingHide(e),200===a.status&&0===a.data.code){toast("回答成功,已到账奖励："+e.global.backendConfig.answerReward+"积分"),e.myanswer={accept:0,agree:0,ask_id:e.ask.uuid,comment_new:"",comment_num:0,comments:[],comments_show:!1,content:e.myanswerInput,create_at:(new Date).getTime(),disagree:0,nickname:e.user.nick,avatar:e.user.avatar,user_id:e.user.uuid,uuid:a.data.data},e.myanswerInput="",e.editorShow=!1,e.totalAnswerNum++;var t=JSON.parse(JSON.stringify(e.user));t.coin+=parseInt(e.global.backendConfig.answerReward),e.user=t,w.a.setItem("user",JSON.stringify(e.user))}}))}else toast("请输入你的回答")},ianswer:function(){this.editorShow?this.editorShow=!1:this.editorShow=!0},handleImageAdded:function(e,a,t,s){var n=this,i=(new Date).getTime()+e.name.substring(e.name.length-4);this.util.uploadFile2OSS(this,i,e,!0,null,(function(){a.insertEmbed(t,"image",n.global.api.aliyunosshostpubread+"/"+i),s()}))}}},h=d,p=(t("8216"),t("2877")),g=t("eebe"),f=t.n(g),y=t("9989"),v=t("9c40"),k=t("eb85"),_=t("3b16"),b=Object(p["a"])(h,s,n,!1,null,"5935b9df",null);a["default"]=b.exports;f()(b,"components",{QPage:y["a"],QBtn:v["a"],QSeparator:k["a"],QPagination:_["a"]})}}]);